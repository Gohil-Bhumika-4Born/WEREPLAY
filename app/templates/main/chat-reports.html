{% extends "base/main_base.html" %}

{% set current_page = 'chat_reports' %}

{% block title %}WeReplay Admin Panel - Chat Reports{% endblock %}

{% block page_title %}Chat Reports{% endblock %}

{% block page_icon %}
<svg class="w-6 h-6 text-primaryDark dark:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
</svg>
{% endblock %}

{% block main_content %}
<!-- Chat Reports Content -->
            <div class="p-4 sm:p-6 lg:p-8 space-y-6 sm:space-y-8">
                <!-- Page Title + Description -->
                <section
                    class="relative mt-3 sm:mt-4 lg:mt-5 overflow-hidden rounded-2xl sm:rounded-3xl bg-white/90 dark:bg-[#252525] border border-primary/15 dark:border-primary/20 shadow-lg shadow-primary/5 dark:shadow-black/30 px-4 sm:px-6 lg:px-8 py-4 sm:py-5 lg:py-6">
                    <div class="absolute inset-0 bg-gradient-to-r from-primary/10 via-transparent to-primaryDark/10 opacity-80 pointer-events-none"></div>
                    <div class="relative z-10 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
                        <div>
                            <p class="text-[11px] sm:text-xs font-semibold tracking-[0.22em] uppercase text-primaryDark/80 mb-1 dark:text-white">
                                Analytics · Chat Topics
                            </p>
                            <h2 class="text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 dark:text-white leading-tight">
                                Conversation Overview
                            </h2>
                            <p class="mt-1 text-xs sm:text-sm text-gray-600 dark:text-gray-300 max-w-xl">
                                Track what your users are asking, how they feel, and where your AI needs improvement — all in one glance.
                            </p>
                        </div>
                        <!-- Quick Stats Pills -->
                        <div class="grid grid-cols-2 sm:grid-cols-2 gap-2 sm:gap-3 min-w-[220px] sm:min-w-[260px]">
                            <div
                                class="rounded-2xl bg-light/80 dark:bg-[#1E1E1E] border border-primary/20 px-3 py-2.5 sm:px-4 sm:py-3 flex flex-col justify-center">
                                <span class="text-[11px] sm:text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide">
                                    Total Topics
                                </span>
                                <span id="totalTopicsCount"
                                      class="text-lg sm:text-xl font-extrabold text-primaryDark dark:text-white leading-snug">
                                    {{ stats.total }}
                                </span>
                            </div>
                            <div
                                class="rounded-2xl bg-primary/5 dark:bg-[#12352a] border border-primary/30 px-3 py-2.5 sm:px-4 sm:py-3 flex flex-col justify-center">
                                <span class="text-[11px] sm:text-xs font-semibold text-gray-500 dark:text-gray-300 uppercase tracking-wide">
                                    Positive % 
                                </span>
                                <span id="positivePercent"
                                      class="text-lg sm:text-xl font-extrabold text-primaryDark dark:text-primary leading-snug">
                                    {{ stats.positive_percent }}%
                                </span>
                            </div>
                            <div
                                class="rounded-2xl bg-red-50/90 dark:bg-red-900/20 border border-red-200/80 dark:border-red-700/60 px-3 py-2.5 sm:px-4 sm:py-3 flex flex-col justify-center">
                                <span class="text-[11px] sm:text-xs font-semibold text-red-700/90 dark:text-red-300 uppercase tracking-wide">
                                    Frustrated
                                </span>
                                <span id="frustratedCount"
                                      class="text-lg sm:text-xl font-extrabold text-red-600 dark:text-red-300 leading-snug">
                                    {{ stats.frustrated }}
                                </span>
                            </div>
                            <div
                                class="rounded-2xl bg-gray-50/90 dark:bg-[#1E1E1E] border border-gray-200/80 dark:border-gray-700 px-3 py-2.5 sm:px-4 sm:py-3 flex flex-col justify-center">
                                <span class="text-[11px] sm:text-xs font-semibold text-gray-500 dark:text-gray-300 uppercase tracking-wide">
                                    Avg. Messages
                                </span>
                                <span id="avgMessages"
                                      class="text-lg sm:text-xl font-extrabold text-gray-900 dark:text-white leading-snug">
                                    {{ stats.avg_messages }}
                                </span>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- Filters Panel -->
                <section
                    class="relative overflow-hidden rounded-2xl sm:rounded-3xl bg-white/95 dark:bg-[#252525] border border-primary/15 dark:border-primary/25 shadow-lg shadow-primary/10 dark:shadow-black/40 p-4 sm:p-6 lg:p-7">
                    <div class="absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(24,203,150,0.12),_transparent_55%)] pointer-events-none opacity-90"></div>
                    <div class="relative z-10 flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-4">
                        <div>
                            <h2 class="text-base sm:text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2">
                                <span class="inline-flex items-center justify-center w-7 h-7 rounded-full bg-primary/10 dark:text-white text-primaryDark">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M3 4a1 1 0 011-1h4a1 1 0 011 1v3H3V4zm0 7h9a1 1 0 011 1v3H3v-3a1 1 0 011-1zm0 7h15a1 1 0 001-1v-2H3v2a1 1 0 001 1zM14 4h6m-3-3v6"/>
                                    </svg>
                                </span>
                                Smart Filters
                            </h2>
                            <p class="mt-1 text-xs sm:text-sm text-gray-600 dark:text-gray-300">
                                Narrow down conversations by sentiment, topic type, date range, and volume.
                            </p>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="applyFilters()" class="inline-flex items-center gap-2 px-4 py-2 bg-[#18CB96] hover:bg-primaryDark dark:bg-[#18CB96] dark:hover:bg-primaryDark text-white rounded-full font-semibold transition-all duration-300 ease-out hover:scale-[1.02] text-xs sm:text-sm shadow-md shadow-primary/30 hover:shadow-lg hover:shadow-[#18CB96]/30">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M3 4h18M5 8h14l-5 6v5l-4-2v-3l-5-6z"/>
                                </svg>
                                Apply Filters
                            </button>
                            <button onclick="resetFilters()" class="inline-flex items-center gap-2 px-4 py-2 bg-white/70 dark:bg-[#333333] hover:bg-primaryDark/90 hover:text-white dark:hover:bg-primaryDark/90 text-gray-700 dark:text-white rounded-full font-medium transition-all duration-300 ease-out hover:scale-[1.02] text-xs sm:text-sm border input-border-gray dark:border-gray-600/70">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M4 4v5h.582M20 20v-5h-.581M5 9a7 7 0 0111.95-4.95M19 15a7 7 0 01-11.95 4.95"/>
                                </svg>
                                Clear
                            </button>
                        </div>
                    </div>
                    
                    <div class="relative z-10 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4">
                        <!-- Sentiment Filter -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Sentiment</label>
                            <select id="sentimentFilter" onchange="applyFilters()" class="w-full px-4 py-2.5 bg-white dark:bg-[#1E1E1E] border input-border-gray rounded-xl text-gray-900 dark:text-white focus:ring-2 focus:ring-[#18CB96] text-sm">
                                <option value="" {% if not filters.sentiment %}selected{% endif %}>All</option>
                                <option value="NORMAL" {% if filters.sentiment == 'NORMAL' %}selected{% endif %}>Normal</option>
                                <option value="FRUSTRATED" {% if filters.sentiment == 'FRUSTRATED' %}selected{% endif %}>Frustrated</option>
                                <option value="POSITIVE" {% if filters.sentiment == 'POSITIVE' %}selected{% endif %}>Positive</option>
                            </select>
                        </div>
                        
                        <!-- Category Filter -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Category</label>
                            <select id="categoryFilter" onchange="applyFilters()" class="w-full px-4 py-2.5 bg-white dark:bg-[#1E1E1E] border input-border-gray rounded-xl text-gray-900 dark:text-white focus:ring-2 focus:ring-[#18CB96] text-sm">
                                <option value="" {% if not filters.category %}selected{% endif %}>All</option>
                                <option value="question" {% if filters.category == 'question' %}selected{% endif %}>Question</option>
                                <option value="bug" {% if filters.category == 'bug' %}selected{% endif %}>Bug</option>
                                <option value="error" {% if filters.category == 'error' %}selected{% endif %}>Error</option>
                                <option value="feature_request" {% if filters.category == 'feature_request' %}selected{% endif %}>Feature Request</option>
                                <option value="other" {% if filters.category == 'other' %}selected{% endif %}>Other</option>
                            </select>
                        </div>
                        
                        <!-- Date Range Filter -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Date From</label>
                            <input type="date" id="dateFrom" value="{{ filters.date_from }}" onchange="applyFilters()" class="w-full px-4 py-2.5 bg-white dark:bg-[#1E1E1E] border input-border-gray rounded-xl text-gray-900 dark:text-white focus:ring-2 focus:ring-[#18CB96] text-sm">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Date To</label>
                            <input type="date" id="dateTo" value="{{ filters.date_to }}" onchange="applyFilters()" class="w-full px-4 py-2.5 bg-white dark:bg-[#1E1E1E] border input-border-gray rounded-xl text-gray-900 dark:text-white focus:ring-2 focus:ring-[#18CB96] text-sm">
                        </div>
                        
                        <!-- Message Count Range -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Message Count</label>
                            <div class="flex gap-2">
                                <input type="number" id="minMessages" value="{{ filters.min_messages or '' }}" onchange="applyFilters()" placeholder="Min" class="w-full px-3 py-2.5 bg-white dark:bg-[#1E1E1E] border input-border-gray rounded-xl text-gray-900 dark:text-white focus:ring-2 focus:ring-[#18CB96] text-sm">
                                <input type="number" id="maxMessages" value="{{ filters.max_messages or '' }}" onchange="applyFilters()" placeholder="Max" class="w-full px-3 py-2.5 bg-white dark:bg-[#1E1E1E] border input-border-gray rounded-xl text-gray-900 dark:text-white focus:ring-2 focus:ring-[#18CB96] text-sm">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Search -->
                    <div class="relative z-10 mt-4">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Search</label>
                        <div class="relative">
                            <span class="absolute inset-y-0 left-3 flex items-center pointer-events-none">
                                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M21 21l-4.35-4.35M11 19a8 8 0 100-16 8 8 0 000 16z"/>
                                </svg>
                            </span>
                            <input
                                type="text"
                                id="searchFilter"
                                placeholder="Search by title or description..."
                                value="{{ filters.search }}"
                                onkeydown="if(event.key === 'Enter') applyFilters()"
                                class="w-full pl-9 pr-3 py-2.5 bg-white/90 dark:bg-[#1E1E1E] border input-border-gray rounded-xl text-gray-900 dark:text-white focus:ring-2 focus:ring-[#18CB96] text-sm placeholder:text-gray-400 dark:placeholder:text-gray-500">
                        </div>
                    </div>
                </section>
                
                <!-- Chat Reports Table -->
                <section class="bg-white/95 dark:bg-[#252525] rounded-2xl sm:rounded-3xl shadow-lg shadow-primary/10 dark:shadow-black/40 overflow-hidden">
                    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between p-4 sm:p-6">
                        <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-2 sm:mb-0">Chat Topics</h3>
                        <div class="flex flex-wrap gap-2">
                            <select id="rowsPerPage" class="px-3 py-2 bg-white dark:bg-[#1E1E1E] border input-border-gray rounded-lg text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-[#18CB96]">
                                <option value="10" {% if filters.per_page == 10 %}selected{% endif %}>10 per page</option>
                                <option value="20" {% if filters.per_page == 20 %}selected{% endif %}>20 per page</option>
                                <option value="50" {% if filters.per_page == 50 %}selected{% endif %}>50 per page</option>
                                <option value="100" {% if filters.per_page == 100 %}selected{% endif %}>100 per page</option>
                            </select>
                            <button onclick="exportReport()" class="px-4 py-2 bg-[#18CB96] hover:bg-primaryDark text-white rounded-lg font-medium transition-all duration-300 ease-out hover:scale-[1.02] hover:shadow-lg hover:shadow-[#18CB96]/30 text-sm flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                                Export Report
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto rounded-xl overflow-hidden">
                        <table class="w-full border-collapse">
                            <thead>
                                <tr class="bg-primaryDark dark:from-[#1E1E1E] dark:to-[#2A2A2A]">
                                    <th class="text-left py-4 px-6 text-sm font-bold text-white dark:text-white uppercase tracking-wider rounded-tl-xl">Title & Description</th>
                                    <th class="text-left py-4 px-6 text-sm font-bold text-white dark:text-white uppercase tracking-wider">Sentiment</th>
                                    <th class="text-left py-4 px-6 text-sm font-bold text-white dark:text-white uppercase tracking-wider">Category</th>
                                    <th class="text-left py-4 px-6 text-sm font-bold text-white dark:text-white uppercase tracking-wider">Messages</th>
                                    <th class="text-left py-4 px-6 text-sm font-bold text-white dark:text-white uppercase tracking-wider">Last Updated</th>
                                    <th class="text-left py-4 px-6 text-sm font-bold text-white dark:text-white uppercase tracking-wider rounded-tr-xl">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="chatReportsTable">
                                {% if pagination.items %}
                                    {% for item in pagination.items %}
                                    {% set is_last_row = loop.last %}
                                    <tr class="{% if loop.index0 % 2 == 0 %}bg-primaryDark/5 dark:bg-[#2A2A2A]{% else %}bg-gray-50 dark:bg-[#1E1E1E]{% endif %} hover:bg-gray-100 dark:hover:bg-[#333333] transition-all duration-300 ease-out cursor-pointer" onclick="viewTopicDetails({{ item.id }})">
                                        <td class="py-4 px-6 {% if is_last_row %}rounded-bl-xl{% endif %}">
                                            <div>
                                                <p class="font-semibold text-gray-900 dark:text-white mb-1">{{ item.title }}</p>
                                                <p class="text-sm text-gray-600 dark:text-gray-400">{{ item.description }}</p>
                                            </div>
                                        </td>
                                        <td class="py-4 px-6">
                                            <span class="px-2.5 py-1 text-xs font-medium rounded-full 
                                                {% if item.sentiment == 'POSITIVE' %}bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400
                                                {% elif item.sentiment == 'FRUSTRATED' %}bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-400
                                                {% else %}bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400{% endif %}">
                                                {{ item.sentiment }}
                                            </span>
                                        </td>
                                        <td class="py-4 px-6">
                                            <span class="px-2.5 py-1 text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 rounded-full">{{ item.category or 'N/A' }}</span>
                                        </td>
                                        <td class="py-4 px-6">
                                            <span class="text-sm font-medium text-gray-900 dark:text-white">{{ item.message_count }}</span>
                                        </td>
                                        <td class="py-4 px-6">
                                            <span class="text-sm text-gray-600 dark:text-gray-400">{{ item.last_check_time }}</span>
                                        </td>
                                        <td class="py-4 px-6 {% if is_last_row %}rounded-br-xl{% endif %}">
                                            <button onclick="event.stopPropagation(); viewTopicDetails({{ item.id }})" class="text-sm text-[#18CB96] hover:text-primaryDark font-medium transition-all duration-300 ease-out hover:scale-105">View Details</button>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr>
                                        <td colspan="6" class="p-12 text-center">
                                            <div class="flex flex-col items-center justify-center">
                                                <svg class="w-16 h-16 mx-auto text-gray-400 dark:text-gray-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                                </svg>
                                                <p class="text-lg font-medium text-gray-900 dark:text-white mb-2">No chat topics found</p>
                                                <p class="text-sm text-gray-600 dark:text-gray-400">Try adjusting your filters or search criteria</p>
                                            </div>
                                        </td>
                                    </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Empty State (Server Side handles this in the table body now) -->
                    <!-- <div id="emptyState" class="hidden p-12 text-center"> ... </div> -->
                </section>
                
                <!-- Server-Side Pagination -->
                {% if pagination.total > 0 %}
                <section class="flex flex-col sm:flex-row items-center justify-between gap-4 bg-white/95 dark:bg-[#252525] rounded-2xl sm:rounded-3xl shadow-lg shadow-primary/5 dark:shadow-black/30 p-4 sm:p-6">
                    <div class="text-sm text-gray-600 dark:text-gray-400">
                        Showing <span class="font-medium text-gray-900 dark:text-white">{{ (pagination.page - 1) * pagination.per_page + 1 }}</span> to <span class="font-medium text-gray-900 dark:text-white">{{ [(pagination.page * pagination.per_page), pagination.total]|min }}</span> of <span class="font-medium text-gray-900 dark:text-white">{{ pagination.total }}</span> results
                    </div>
                    <div class="flex items-center gap-2">
                        <!-- Previous Button -->
                        <button onclick="goToPage({{ pagination.prev_num }})" {% if not pagination.has_prev %}disabled{% endif %} class="px-4 py-2 bg-gray-100 dark:bg-[#333333] hover:bg-gray-200 dark:hover:bg-[#3A3A3A] text-gray-700 dark:text-gray-300 rounded-full font-medium transition-all duration-300 ease-out hover:scale-[1.02] text-sm disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100">
                            Previous
                        </button>
                        
                        <div class="flex items-center gap-1">
                            {% for page_num in pagination.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
                                {% if page_num %}
                                    {% if page_num == pagination.page %}
                                        <button class="px-3 py-2 rounded-lg font-medium text-sm bg-[#18CB96] text-white shadow-md cursor-default">
                                            {{ page_num }}
                                        </button>
                                    {% else %}
                                        <button onclick="goToPage({{ page_num }})" class="px-3 py-2 rounded-lg font-medium text-sm bg-gray-100 dark:bg-[#333333] text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-[#3A3A3A] transition-all duration-300 ease-out hover:scale-[1.05]">
                                            {{ page_num }}
                                        </button>
                                    {% endif %}
                                {% else %}
                                    <span class="px-2 text-gray-500 dark:text-gray-400">...</span>
                                {% endif %}
                            {% endfor %}
                        </div>

                        <!-- Next Button -->
                        <button onclick="goToPage({{ pagination.next_num }})" {% if not pagination.has_next %}disabled{% endif %} class="px-4 py-2 bg-gray-100 dark:bg-[#333333] hover:bg-gray-200 dark:hover:bg-[#3A3A3A] text-gray-700 dark:text-gray-300 rounded-full font-medium transition-all duration-300 ease-out hover:scale-[1.02] text-sm disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100">
                            Next
                        </button>
                    </div>
                </section>
                {% endif %}
            </div>
        </main>
    </div>
{% endblock %}

{% block extra_scripts %}
<script>
    // URL Construction for Server-Side Filtering
    function buildFilterParams(pageOverride) {
        const sentiment = document.getElementById('sentimentFilter').value;
        const category = document.getElementById('categoryFilter').value;
        const dateFrom = document.getElementById('dateFrom').value;
        const dateTo = document.getElementById('dateTo').value;
        const minMessages = document.getElementById('minMessages').value;
        const maxMessages = document.getElementById('maxMessages').value;
        const search = document.getElementById('searchFilter').value;
        const rowsPerPage = document.getElementById('rowsPerPage').value;
        
        let params = new URLSearchParams(window.location.search);
        
        // Update params with new values
        if (sentiment) params.set('sentiment', sentiment); else params.delete('sentiment');
        if (category) params.set('category', category); else params.delete('category');
        if (dateFrom) params.set('date_from', dateFrom); else params.delete('date_from');
        if (dateTo) params.set('date_to', dateTo); else params.delete('date_to');
        if (minMessages) params.set('min_messages', minMessages); else params.delete('min_messages');
        if (maxMessages) params.set('max_messages', maxMessages); else params.delete('max_messages');
        if (search) params.set('search', search); else params.delete('search');
        if (rowsPerPage) params.set('per_page', rowsPerPage);
        
        // Handle Page
        if (pageOverride) {
            params.set('page', pageOverride);
        } else {
            // Reset to page 1 on filter change
            params.set('page', 1); 
        }
        
        return params.toString();
    }
    
    function applyFilters() {
        const queryParams = buildFilterParams();
        window.location.href = "{{ url_for('main.chat_reports') }}?" + queryParams;
    }
    
    function goToPage(pageNum) {
        if (!pageNum) return;
        const queryParams = buildFilterParams(pageNum);
        window.location.href = "{{ url_for('main.chat_reports') }}?" + queryParams;
    }
    
    function resetFilters() {
        window.location.href = "{{ url_for('main.chat_reports') }}";
    }
    
    // Auto-apply rows per page change
    document.getElementById('rowsPerPage').addEventListener('change', () => {
        applyFilters();
    });

    // View Topic Details
    function viewTopicDetails(topicId) {
        // Redirect to topic details page
        window.location.href = "{{ url_for('main.chat_reports_details') }}?topicId=" + topicId;
    }
    
    // Export Report
    function exportReport() {
        alert('Exporting report... This would download the report in selected format.');
    }
</script>
{% endblock %}
